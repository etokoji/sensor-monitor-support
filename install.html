<!doctype html>
<html lang="ja">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>EtoTHSensorMonitor ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«</title>
        <style>
            body {
                font-family:
                    -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
                    sans-serif;
                max-width: 600px;
                margin: 50px auto;
                padding: 20px;
                text-align: center;
                background-color: #f8f9fa;
            }
            .app-icon {
                width: 120px;
                height: 120px;
                border-radius: 20px;
                margin: 20px auto;
                display: block;
                box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            }
            .install-button {
                display: inline-block;
                background-color: #007aff;
                color: white;
                padding: 15px 30px;
                text-decoration: none;
                border-radius: 8px;
                font-size: 18px;
                margin: 20px 0;
                transition: all 0.3s ease;
            }
            .install-button:hover {
                background-color: #0051d0;
                transform: translateY(-1px);
            }
            .install-button:active {
                transform: translateY(0);
            }
            .info {
                background-color: white;
                padding: 20px;
                border-radius: 12px;
                margin: 20px 0;
                text-align: left;
                box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            }
            .status-message {
                padding: 15px;
                border-radius: 8px;
                margin: 20px 0;
                font-weight: 500;
                display: none;
            }
            .status-success {
                background-color: #d4edda;
                color: #155724;
                border: 1px solid #c3e6cb;
            }
            .status-installing {
                background-color: #d1ecf1;
                color: #0c5460;
                border: 1px solid #bee5eb;
            }
            .loading-spinner {
                display: inline-block;
                width: 20px;
                height: 20px;
                border: 3px solid #f3f3f3;
                border-top: 3px solid #007aff;
                border-radius: 50%;
                animation: spin 1s linear infinite;
                margin-right: 10px;
                vertical-align: middle;
            }
            @keyframes spin {
                0% { transform: rotate(0deg); }
                100% { transform: rotate(360deg); }
            }
            
            /* iPadå¯¾å¿œã®CSS */
            @media screen and (min-width: 768px) {
                body {
                    max-width: 800px;
                    margin: 100px auto;
                }
                .app-icon {
                    width: 150px;
                    height: 150px;
                }
                .install-button {
                    font-size: 20px;
                    padding: 20px 40px;
                }
                h1 {
                    font-size: 2.5rem;
                }
            }
        </style>
    </head>
    <body>
        <img src="web_icons/icon_1024x1024_512x512.png" alt="EtoTHSensorMonitor" class="app-icon">
        <h1>EtoTHSensorMonitor</h1>
        <p>iOSå‘ã‘ç’°å¢ƒã‚»ãƒ³ã‚µãƒ¼ç›£è¦–ã‚¢ãƒ—ãƒª</p>

        <div id="installStatus" class="status-message"></div>

        <a
            href="itms-services://?action=download-manifest&url=https://etokoji.github.io/sensor-monitor-support/manifest.plist"
            class="install-button"
            id="installButton"
            onclick="handleInstallClick()"
        >
            ã‚¢ãƒ—ãƒªã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
        </a>

        <div class="info">
            <h3>ğŸ“± ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ‰‹é †ï¼š</h3>
            <ol>
                <li>ä¸Šè¨˜ã®ã€Œã‚¢ãƒ—ãƒªã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã€ãƒœã‚¿ãƒ³ã‚’ã‚¿ãƒƒãƒ—</li>
                <li>ã€Œã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã€ã‚’ã‚¿ãƒƒãƒ—ã—ã¦ç¢ºèª</li>
                <li>ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰å®Œäº†ã‚’å¾…ã¤ï¼ˆæ•°åˆ†ã‹ã‹ã‚‹å ´åˆãŒã‚ã‚Šã¾ã™ï¼‰</li>
                <li>ãƒ›ãƒ¼ãƒ ç”»é¢ã«ã‚¢ãƒ—ãƒªã‚¢ã‚¤ã‚³ãƒ³ãŒè¡¨ç¤ºã•ã‚ŒãŸã‚‰ã‚¿ãƒƒãƒ—</li>
                <li>åˆå›èµ·å‹•æ™‚ã¯ã€Œä¿¡é ¼ã•ã‚Œã¦ã„ãªã„é–‹ç™ºè€…ã€ã‚¨ãƒ©ãƒ¼ãŒå‡ºãŸã‚‰ï¼š<br>
                    è¨­å®š > ä¸€èˆ¬ > VPNã¨ãƒ‡ãƒã‚¤ã‚¹ç®¡ç† > ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä¿¡é ¼</li>
            </ol>

            <h3>â„¹ï¸ ã‚¢ãƒ—ãƒªæƒ…å ±ï¼š</h3>
            <ul>
                <li>ãƒãƒ¼ã‚¸ãƒ§ãƒ³: 1.0</li>
                <li>Bundle ID: com.etokoji.EtoTHSensorMonitor</li>
                <li>å¯¾å¿œOS: iOS 14.0ä»¥ä¸Š</li>
                <li>æ¸©åº¦ãƒ»æ¹¿åº¦ãƒ»æ°—åœ§ãƒ‡ãƒ¼ã‚¿ã‚’ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ è¡¨ç¤º</li>
                <li>Bluetoothãƒ»WiFiå¯¾å¿œ</li>
            </ul>

            <h3>âš ï¸ æ³¨æ„äº‹é …ï¼š</h3>
            <ul>
                <li>iOSãƒ‡ãƒã‚¤ã‚¹ã§ã®ã¿ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«å¯èƒ½ã§ã™</li>
                <li>åˆå›èµ·å‹•æ™‚ã¯ã€Œä¿¡é ¼ã•ã‚Œã¦ã„ãªã„é–‹ç™ºè€…ã€ã®è¨­å®šãŒå¿…è¦ã§ã™</li>
                <li>ã‚«ã‚¹ã‚¿ãƒ ãƒ•ã‚¡ãƒ¼ãƒ ã‚¦ã‚§ã‚¢å¯¾å¿œã®ESP32ãƒ‡ãƒã‚¤ã‚¹ãŒå¿…è¦ã§ã™</li>
            </ul>
        </div>

        <script>
            function handleInstallClick() {
                const statusDiv = document.getElementById('installStatus');
                const button = document.getElementById('installButton');
                
                // ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«é–‹å§‹ã®è¡¨ç¤º
                statusDiv.innerHTML = '<span class="loading-spinner"></span>ã‚¢ãƒ—ãƒªã®ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã‚’é–‹å§‹ã—ã¦ã„ã¾ã™...';
                statusDiv.className = 'status-message status-installing';
                statusDiv.style.display = 'block';
                
                button.style.opacity = '0.6';
                button.style.pointerEvents = 'none';
                
                // 3ç§’å¾Œã«ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ä¸­ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤º
                setTimeout(() => {
                    statusDiv.innerHTML = '<span class="loading-spinner"></span>ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ä¸­... ã—ã°ã‚‰ããŠå¾…ã¡ãã ã•ã„';
                }, 3000);
                
                // 8ç§’å¾Œã«å®Œäº†ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤º
                setTimeout(() => {
                    statusDiv.innerHTML = 'âœ… ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ãŒå®Œäº†ã—ã¾ã—ãŸï¼<br>ğŸ“± ãƒ›ãƒ¼ãƒ ç”»é¢ã§ã‚¢ãƒ—ãƒªã‚¢ã‚¤ã‚³ãƒ³ã‚’ã‚¿ãƒƒãƒ—ã—ã¦ã‚¢ãƒ—ãƒªã‚’èµ·å‹•ã—ã¦ãã ã•ã„';
                    statusDiv.className = 'status-message status-success';
                    
                    button.innerHTML = 'ğŸ”„ å†ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«';
                    button.href = 'itms-services://?action=download-manifest&url=https://etokoji.github.io/sensor-monitor-support/manifest.plist';
                    button.style.opacity = '1';
                    button.style.pointerEvents = 'auto';
                    button.style.backgroundColor = '#6c757d';
                    button.onclick = null; // å…ƒã®ã‚¯ãƒªãƒƒã‚¯ãƒãƒ³ãƒ‰ãƒ©ãƒ¼ã‚’å‰Šé™¤
                }, 8000);
                
                // ã‚¢ãƒ—ãƒªãŒæ—¢ã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹ã‹ãƒã‚§ãƒƒã‚¯
                setTimeout(() => {
                    checkIfAppInstalled();
                }, 10000);
            }
            
            function checkIfAppInstalled() {
                // ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ã‚¤ãƒ™ãƒ³ãƒˆã§ã‚¢ãƒ—ãƒªã®èµ·å‹•ã‚’æ¤œå‡º
                let hidden = false;
                
                const handleVisibilityChange = () => {
                    if (document.hidden) {
                        hidden = true;
                    } else if (hidden) {
                        // ã‚¢ãƒ—ãƒªã‹ã‚‰æˆ»ã£ã¦ããŸå ´åˆ
                        const statusDiv = document.getElementById('installStatus');
                        statusDiv.innerHTML = 'ğŸ‰ ã‚¢ãƒ—ãƒªãŒæ­£å¸¸ã«èµ·å‹•ã—ã¾ã—ãŸï¼ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«å®Œäº†ã§ã™ã€‚';
                        statusDiv.className = 'status-message status-success';
                    }
                };
                
                document.addEventListener('visibilitychange', handleVisibilityChange);
            }
            
            // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã«å®Ÿè¡Œ
            document.addEventListener('DOMContentLoaded', function() {
                // ãƒ‡ãƒãƒƒã‚°æƒ…å ±ã‚’è¡¨ç¤º
                console.log('ğŸ“± User Agent:', navigator.userAgent);
                console.log('ğŸ–¥ï¸ Platform:', navigator.platform);
                console.log('ğŸ‘† Max touch points:', navigator.maxTouchPoints);
                console.log('ğŸ“ Screen size:', screen.width + 'x' + screen.height);
                
                // userAgentãƒã‚§ãƒƒã‚¯ã‚’ç„¡åŠ¹åŒ– - ã™ã¹ã¦ã®ãƒ‡ãƒã‚¤ã‚¹ã§ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ãƒœã‚¿ãƒ³ã‚’è¡¨ç¤º
                console.log('âœ… ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ãƒœã‚¿ãƒ³ã‚’è¡¨ç¤ºã—ã¾ã™ï¼ˆuserAgentãƒã‚§ãƒƒã‚¯ç„¡åŠ¹ï¼‰');
                
                const statusDiv = document.getElementById('installStatus');
                statusDiv.innerHTML = 'ğŸ“± iOS/iPadOSãƒ‡ãƒã‚¤ã‚¹ã§ã€Œã‚¢ãƒ—ãƒªã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã€ãƒœã‚¿ãƒ³ã‚’ã‚¿ãƒƒãƒ—ã—ã¦ãã ã•ã„';
                statusDiv.className = 'status-message';
                statusDiv.style.display = 'block';
                statusDiv.style.backgroundColor = '#e7f3ff';
                statusDiv.style.color = '#0c5460';
                statusDiv.style.border = '1px solid #bee5eb';
            });
        </script>
    </body>
</html>
