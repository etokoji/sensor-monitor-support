<!doctype html>
<html lang="ja">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>EtoTHSensorMonitor ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«</title>
        <style>
            body {
                font-family:
                    -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
                    sans-serif;
                max-width: 600px;
                margin: 50px auto;
                padding: 20px;
                text-align: center;
                background-color: #f8f9fa;
            }
            .app-icon {
                width: 120px;
                height: 120px;
                border-radius: 20px;
                margin: 20px auto;
                display: block;
                box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            }
            .install-button {
                display: inline-block;
                background-color: #007aff;
                color: white;
                padding: 15px 30px;
                text-decoration: none;
                border-radius: 8px;
                font-size: 18px;
                margin: 20px 0;
                transition: all 0.3s ease;
            }
            .install-button:hover {
                background-color: #0051d0;
                transform: translateY(-1px);
            }
            .install-button:active {
                transform: translateY(0);
            }
            .info {
                background-color: white;
                padding: 20px;
                border-radius: 12px;
                margin: 20px 0;
                text-align: left;
                box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            }
            .status-message {
                padding: 15px;
                border-radius: 8px;
                margin: 20px 0;
                font-weight: 500;
                display: none;
            }
            .status-success {
                background-color: #d4edda;
                color: #155724;
                border: 1px solid #c3e6cb;
            }
            .status-installing {
                background-color: #d1ecf1;
                color: #0c5460;
                border: 1px solid #bee5eb;
            }
            .loading-spinner {
                display: inline-block;
                width: 20px;
                height: 20px;
                border: 3px solid #f3f3f3;
                border-top: 3px solid #007aff;
                border-radius: 50%;
                animation: spin 1s linear infinite;
                margin-right: 10px;
                vertical-align: middle;
            }
            @keyframes spin {
                0% { transform: rotate(0deg); }
                100% { transform: rotate(360deg); }
            }
            .version-info {
                background-color: #fff3cd;
                color: #856404;
                padding: 15px;
                border-radius: 8px;
                margin: 20px 0;
                border: 1px solid #ffeaa7;
            }
            .version-info strong {
                color: #6f5499;
            }
            .update-notice {
                background-color: #d1ecf1;
                color: #0c5460;
                padding: 15px;
                border-radius: 8px;
                margin: 20px 0;
                border: 1px solid #bee5eb;
            }
            
            /* iPadå¯¾å¿œã®CSS */
            @media screen and (min-width: 768px) {
                body {
                    max-width: 800px;
                    margin: 100px auto;
                }
                .app-icon {
                    width: 150px;
                    height: 150px;
                }
                .install-button {
                    font-size: 20px;
                    padding: 20px 40px;
                }
                h1 {
                    font-size: 2.5rem;
                }
            }
        </style>
    </head>
    <body>
        <img src="web_icons/icon_1024x1024_512x512.png" alt="EtoTHSensorMonitor" class="app-icon">
        <h1>EtoTHSensorMonitor</h1>
        <p>iOSå‘ã‘ç’°å¢ƒã‚»ãƒ³ã‚µãƒ¼ç›£è¦–ã‚¢ãƒ—ãƒª</p>

        <div id="installStatus" class="status-message"></div>

        <!-- ãƒãƒ¼ã‚¸ãƒ§ãƒ³æƒ…å ±è¡¨ç¤º -->
        <div class="version-info">
            <p><strong>æœ€æ–°ãƒãƒ¼ã‚¸ãƒ§ãƒ³:</strong> <span id="latestVersion">1.1.0</span></p>
            <p><span id="updateDate">2025å¹´10æœˆ4æ—¥</span> ãƒªãƒªãƒ¼ã‚¹</p>
        </div>

        <a
            href="itms-services://?action=download-manifest&url=https://etokoji.github.io/sensor-monitor-support/manifest.plist"
            class="install-button"
            id="installButton"
            onclick="handleInstallClick()"
        >
            <span id="buttonText">ã‚¢ãƒ—ãƒªã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ« / æ›´æ–°</span>
        </a>

        <div class="info">
            <h3>ğŸ“± ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ« / æ›´æ–°æ‰‹é †ï¼š</h3>
            <ol>
                <li>ä¸Šè¨˜ã®ã€Œã‚¢ãƒ—ãƒªã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ« / æ›´æ–°ã€ãƒœã‚¿ãƒ³ã‚’ã‚¿ãƒƒãƒ—</li>
                <li>ã€Œã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã€ã¾ãŸã¯ã€Œç½®ãæ›ãˆã‚‹ã€ã‚’ã‚¿ãƒƒãƒ—ã—ã¦ç¢ºèª</li>
                <li>ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰å®Œäº†ã‚’å¾…ã¤ï¼ˆæ•°åˆ†ã‹ã‹ã‚‹å ´åˆãŒã‚ã‚Šã¾ã™ï¼‰</li>
                <li>ãƒ›ãƒ¼ãƒ ç”»é¢ã«ã‚¢ãƒ—ãƒªã‚¢ã‚¤ã‚³ãƒ³ãŒè¡¨ç¤ºã•ã‚ŒãŸã‚‰ã‚¿ãƒƒãƒ—</li>
                <li>åˆå›ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ™‚ã¯ã€Œä¿¡é ¼ã•ã‚Œã¦ã„ãªã„é–‹ç™ºè€…ã€ã‚¨ãƒ©ãƒ¼ãŒå‡ºãŸã‚‰ï¼š<br>
                    è¨­å®š > ä¸€èˆ¬ > VPNã¨ãƒ‡ãƒã‚¤ã‚¹ç®¡ç† > ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä¿¡é ¼</li>
            </ol>
            
            <div class="update-notice">
                <h4>ğŸ”„ ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆã«ã¤ã„ã¦ï¼š</h4>
                <ul>
                    <li><strong>æ—¢å­˜ã‚¢ãƒ—ãƒªãŒã‚ã‚‹å ´åˆï¼š</strong> è‡ªå‹•çš„ã«æœ€æ–°ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã§ç½®ãæ›ãˆã‚‰ã‚Œã¾ã™</li>
                    <li><strong>ãƒ‡ãƒ¼ã‚¿ä¿æŒï¼š</strong> ã‚¢ãƒ—ãƒªå†…è¨­å®šã¨ãƒ‡ãƒ¼ã‚¿ã¯ä¿æŒã•ã‚Œã¾ã™</li>
                    <li><strong>ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç¢ºèªï¼š</strong> ã‚¢ãƒ—ãƒªèµ·å‹•æ™‚ã«è¨­å®šç”»é¢ã§ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’ç¢ºèªã§ãã¾ã™</li>
                </ul>
            </div>

            <h3>â„¹ï¸ ã‚¢ãƒ—ãƒªæƒ…å ±ï¼š</h3>
            <ul>
                <li><strong>æœ€æ–°ãƒãƒ¼ã‚¸ãƒ§ãƒ³:</strong> 1.1.0 (2025å¹´10æœˆ4æ—¥)</li>
                <li><strong>Bundle ID:</strong> com.etokoji.EtoTHSensorMonitor</li>
                <li><strong>å¯¾å¿œOS:</strong> iOS 17.0ä»¥ä¸Š</li>
                <li><strong>ä¸»ãªæ©Ÿèƒ½:</strong>
                    <ul>
                        <li>æ¸©åº¦ãƒ»æ¹¿åº¦ãƒ»æ°—åœ§ãƒ»é›»åœ§ãƒ‡ãƒ¼ã‚¿ã®ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ è¡¨ç¤º</li>
                        <li>Bluetooth LEé€šä¿¡å¯¾å¿œ</li>
                        <li>iPad mini / Macå‘ã‘ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ</li>
                        <li>å‹•çš„ãƒ•ã‚©ãƒ³ãƒˆã‚µã‚¤ã‚ºèª¿æ•´</li>
                        <li>ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚µã‚¤ã‚ºã«å¿œã˜ãŸè‡ªå‹•èª¿æ•´ï¼ˆMacï¼‰</li>
                    </ul>
                </li>
            </ul>
            
            <h3>ğŸ†• ãƒãƒ¼ã‚¸ãƒ§ãƒ³ 1.1.0 ã®æ–°æ©Ÿèƒ½ï¼š</h3>
            <ul>
                <li>iPad miniã§ã®ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆæœ€é©åŒ–</li>
                <li>Macã§ã®å‹•çš„ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ãƒªã‚µã‚¤ã‚ºå¯¾å¿œ</li>
                <li>è¨ˆæ¸¬å€¤ã®æ–‡å­—ã‚µã‚¤ã‚ºã‚’å…¨ä½“çš„ã«å‘ä¸Š</li>
                <li>ç”»é¢ã‚µã‚¤ã‚ºã«å¿œã˜ãŸé©å¿œå‹ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ</li>
                <li>SwiftUI Previewæ©Ÿèƒ½ã®æ”¹å–„</li>
            </ul>

            <h3>âš ï¸ æ³¨æ„äº‹é …ï¼š</h3>
            <ul>
                <li>iOSãƒ‡ãƒã‚¤ã‚¹ã§ã®ã¿ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«å¯èƒ½ã§ã™</li>
                <li>åˆå›èµ·å‹•æ™‚ã¯ã€Œä¿¡é ¼ã•ã‚Œã¦ã„ãªã„é–‹ç™ºè€…ã€ã®è¨­å®šãŒå¿…è¦ã§ã™</li>
                <li>ã‚«ã‚¹ã‚¿ãƒ ãƒ•ã‚¡ãƒ¼ãƒ ã‚¦ã‚§ã‚¢å¯¾å¿œã®ESP32ãƒ‡ãƒã‚¤ã‚¹ãŒå¿…è¦ã§ã™</li>
            </ul>
        </div>

        <script>
            function handleInstallClick() {
                const statusDiv = document.getElementById('installStatus');
                const button = document.getElementById('installButton');
                const buttonText = document.getElementById('buttonText');
                
                // ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«/æ›´æ–°é–‹å§‹ã®è¡¨ç¤º
                statusDiv.innerHTML = '<span class="loading-spinner"></span>ã‚¢ãƒ—ãƒªã®ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã‚’é–‹å§‹ã—ã¦ã„ã¾ã™...<br>ï¼ˆæ–°è¦ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã¾ãŸã¯æ—¢å­˜ã‚¢ãƒ—ãƒªã®æ›´æ–°ï¼‰';
                statusDiv.className = 'status-message status-installing';
                statusDiv.style.display = 'block';
                
                button.style.opacity = '0.6';
                button.style.pointerEvents = 'none';
                
                // 3ç§’å¾Œã«ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ä¸­ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤º
                setTimeout(() => {
                    statusDiv.innerHTML = '<span class="loading-spinner"></span>ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ä¸­... ã—ã°ã‚‰ããŠå¾…ã¡ãã ã•ã„<br>ğŸ“± æ—¢å­˜ã‚¢ãƒ—ãƒªãŒã‚ã‚‹å ´åˆã¯è‡ªå‹•çš„ã«æ›´æ–°ã•ã‚Œã¾ã™';
                }, 3000);
                
                // 8ç§’å¾Œã«å®Œäº†ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤º
                setTimeout(() => {
                    statusDiv.innerHTML = 'âœ… ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ãŒå®Œäº†ã—ã¾ã—ãŸï¼<br>ğŸ“± ãƒ›ãƒ¼ãƒ ç”»é¢ã§ã‚¢ãƒ—ãƒªã‚¢ã‚¤ã‚³ãƒ³ã‚’ã‚¿ãƒƒãƒ—ã—ã¦ã‚¢ãƒ—ãƒªã‚’èµ·å‹•ã—ã¦ãã ã•ã„<br>ğŸ”„ æ—¢å­˜ã‚¢ãƒ—ãƒªã¯æœ€æ–°ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã«æ›´æ–°ã•ã‚Œã¾ã—ãŸ';
                    statusDiv.className = 'status-message status-success';
                    
                    buttonText.innerHTML = 'ğŸ”„ å†å®Ÿè¡Œï¼ˆå†ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«/æ›´æ–°ï¼‰';
                    button.href = 'itms-services://?action=download-manifest&url=https://etokoji.github.io/sensor-monitor-support/manifest.plist';
                    button.style.opacity = '1';
                    button.style.pointerEvents = 'auto';
                    button.style.backgroundColor = '#28a745';
                    button.onclick = null; // å…ƒã®ã‚¯ãƒªãƒƒã‚¯ãƒãƒ³ãƒ‰ãƒ©ãƒ¼ã‚’å‰Šé™¤
                }, 8000);
                
                // ã‚¢ãƒ—ãƒªãŒæ—¢ã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹ã‹ãƒã‚§ãƒƒã‚¯
                setTimeout(() => {
                    checkIfAppInstalled();
                }, 10000);
            }
            
            function checkIfAppInstalled() {
                // ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ã‚¤ãƒ™ãƒ³ãƒˆã§ã‚¢ãƒ—ãƒªã®èµ·å‹•ã‚’æ¤œå‡º
                let hidden = false;
                
                const handleVisibilityChange = () => {
                    if (document.hidden) {
                        hidden = true;
                    } else if (hidden) {
                        // ã‚¢ãƒ—ãƒªã‹ã‚‰æˆ»ã£ã¦ããŸå ´åˆ
                        const statusDiv = document.getElementById('installStatus');
                        statusDiv.innerHTML = 'ğŸ‰ ã‚¢ãƒ—ãƒªãŒæ­£å¸¸ã«èµ·å‹•ã—ã¾ã—ãŸï¼ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«å®Œäº†ã§ã™ã€‚';
                        statusDiv.className = 'status-message status-success';
                    }
                };
                
                document.addEventListener('visibilitychange', handleVisibilityChange);
            }
            
            // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã«å®Ÿè¡Œ
            document.addEventListener('DOMContentLoaded', function() {
                // ãƒ‡ãƒãƒƒã‚°æƒ…å ±ã‚’è¡¨ç¤º
                console.log('ğŸ“± User Agent:', navigator.userAgent);
                console.log('ğŸ–¥ï¸ Platform:', navigator.platform);
                console.log('ğŸ‘† Max touch points:', navigator.maxTouchPoints);
                console.log('ğŸ“ Screen size:', screen.width + 'x' + screen.height);
                
                // userAgentãƒã‚§ãƒƒã‚¯ã‚’ç„¡åŠ¹åŒ– - ã™ã¹ã¦ã®ãƒ‡ãƒã‚¤ã‚¹ã§ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ãƒœã‚¿ãƒ³ã‚’è¡¨ç¤º
                console.log('âœ… ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ãƒœã‚¿ãƒ³ã‚’è¡¨ç¤ºã—ã¾ã™ï¼ˆuserAgentãƒã‚§ãƒƒã‚¯ç„¡åŠ¹ï¼‰');
                
                const statusDiv = document.getElementById('installStatus');
                statusDiv.innerHTML = 'ğŸ“± iOS/iPadOSãƒ‡ãƒã‚¤ã‚¹ã§ã€Œã‚¢ãƒ—ãƒªã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ« / æ›´æ–°ã€ãƒœã‚¿ãƒ³ã‚’ã‚¿ãƒƒãƒ—ã—ã¦ãã ã•ã„<br>ğŸ”„ æ—¢ã«ã‚¢ãƒ—ãƒªãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹å ´åˆã¯è‡ªå‹•çš„ã«æœ€æ–°ç‰ˆã«æ›´æ–°ã•ã‚Œã¾ã™';
                statusDiv.className = 'status-message';
                statusDiv.style.display = 'block';
                statusDiv.style.backgroundColor = '#e7f3ff';
                statusDiv.style.color = '#0c5460';
                statusDiv.style.border = '1px solid #bee5eb';
            });
        </script>
    </body>
</html>
